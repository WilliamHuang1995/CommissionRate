(function(e){function t(t){for(var n,i,u=t[0],s=t[1],c=t[2],d=0,v=[];d<u.length;d++)i=u[d],o[i]&&v.push(o[i][0]),o[i]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);l&&l(t);while(v.length)v.shift()();return a.push.apply(a,c||[]),r()}function r(){for(var e,t=0;t<a.length;t++){for(var r=a[t],n=!0,u=1;u<r.length;u++){var s=r[u];0!==o[s]&&(n=!1)}n&&(a.splice(t--,1),e=i(i.s=r[0]))}return e}var n={},o={app:0},a=[];function i(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=n,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/CommissionRate/";var u=window["webpackJsonp"]=window["webpackJsonp"]||[],s=u.push.bind(u);u.push=t,u=u.slice();for(var c=0;c<u.length;c++)t(u[c]);var l=s;a.push([1,"chunk-vendors"]),r()})({0:function(e,t){},"034f":function(e,t,r){"use strict";var n=r("64a9"),o=r.n(n);o.a},1:function(e,t,r){e.exports=r("56d7")},2:function(e,t){},3:function(e,t){},"56d7":function(e,t,r){"use strict";r.r(t);r("cadf"),r("551c"),r("f751"),r("097d");var n=r("2b0e"),o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("div",{directives:[{name:"show",rawName:"v-show",value:e.loaded,expression:"loaded"}],staticClass:"landing"},[r("h1",[e._v("Commission Rate")]),r("p",[e._v("a time-saving application that calculates commissions for employees.")]),r("vue-dropzone",{ref:"myVueDropzone",attrs:{id:"dropzone",options:e.dropzoneOptions},on:{"vdropzone-success":e.onSuccess}}),e._m(0)],1),e.array?r("table",[r("tbody",[e._m(1),e._l(e.computedArray,function(t,n){return r("tr",{key:n},[r("td",[e._v(e._s(t[0]))]),r("td",[e._v(e._s(t[1]))]),r("td",[e._v(e._s(t[2]))]),r("td",[e._v(e._s(t[3]))]),r("td",[e._v(e._s(t[4]))]),r("td",[e._v(e._s(t[5]))]),r("td",[e._v(e._s(t[6]))]),r("td",[e._v(e._s(t[7]))]),r("td",[e._v(e._s(t[8]))])])})],2)]):e._e(),e.array?r("div",{staticClass:"center"},[r("button",{on:{click:e.download}},[e._v("Download")])]):e._e()])},a=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ol",[r("li",[e._v("Upload an excel (.xlsx) file. File should be no larger than 5MB.")]),r("li",[e._v("Make sure the first sheet is the one you want the application to read")]),r("li",[r("p",[e._v("Make sure you have the following fields (having more fields is okay):")]),r("ul",[r("li",[e._v("業務員")]),r("li",[e._v("客戶簡稱")]),r("li",[e._v("貨品名稱")]),r("li",[e._v("銷貨金額")])])]),r("li",[r("p",[e._v("Make sure the commissioned items contain the following words:")]),r("ul",[r("li",[e._v("硬化劑")]),r("li",[e._v("發泡劑")]),r("li",[e._v("設備")]),r("li",[e._v("薄膜")])])])])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("tr",[r("th",[e._v("業務員")]),r("th",[e._v("客戶簡稱")]),r("th",[e._v("貨品名稱")]),r("th",[e._v("銷貨金額")]),r("th",[e._v("0.5%")]),r("th",[e._v("1.5%")]),r("th",[e._v("3.0%")]),r("th",[e._v("3.5%")]),r("th",[e._v("5.0%")])])}],i=(r("34ef"),r("768b")),u=(r("ac6a"),r("ffc1"),r("bd86")),s=(r("6762"),r("2fdb"),r("55dd"),r("92c3")),c=r.n(s),l=(r("1e3f"),r("1146")),d=r.n(l),v={name:"app",components:{vueDropzone:c.a},data:function(){return{dropzoneOptions:{url:"https://httpbin.org/post",thumbnailWidth:150,maxFilesize:5},commissionedItems:["硬化劑","發泡劑","設備","薄膜"],array:"",loaded:!0}},computed:{computedArray:function(){var e=this;if(this.array){var t=this.array.filter(function(t){return e.commissionedItems.some(function(e){return t["貨品名稱"].includes(e)})}).map(function(e){return{employee:e["業務員"],customer:e["客戶簡稱"],product:e["貨品名稱"],revenue:e["銷貨金額"]}}).sort(function(e,t){var r=e.employee.toUpperCase(),n=t.employee.toUpperCase(),o=0;return r>n?o=1:r<n&&(o=-1),o}),r={};while(t.length){var n=t.shift();if(r[n.employee])if(r[n.employee][n.customer])if(r[n.employee][n.customer][n.product]){var o=r[n.employee][n.customer][n.product]["原本"]+n.revenue;r[n.employee][n.customer][n.product]={"原本":o,"0.5%":.005*o,"1.5%":.015*o,"3.0%":.03*o,"3.5%":.035*o,"5.0%":.05*o}}else r[n.employee][n.customer][n.product]={"原本":n.revenue,"0.5%":.005*n.revenue,"1.5%":.015*n.revenue,"3.0%":.03*n.revenue,"3.5%":.035*n.revenue,"5.0%":.05*n.revenue};else r[n.employee][n.customer]=Object(u["a"])({},n.product,{"原本":n.revenue,"0.5%":.005*n.revenue,"1.5%":.015*n.revenue,"3.0%":.03*n.revenue,"3.5%":.035*n.revenue,"5.0%":.05*n.revenue});else r[n.employee]=Object(u["a"])({},n.customer,Object(u["a"])({},n.product,{"原本":n.revenue,"0.5%":.005*n.revenue,"1.5%":.015*n.revenue,"3.0%":.03*n.revenue,"3.5%":.035*n.revenue,"5.0%":.05*n.revenue}))}for(var a=[],s=Object.entries(r),c=0,l=s;c<l.length;c++)for(var d=Object(i["a"])(l[c],2),v=d[0],p=d[1],f=Object.entries(p),m=0,h=f;m<h.length;m++)for(var _=Object(i["a"])(h[m],2),y=_[0],b=_[1],w=Object.entries(b),g=0,O=w;g<O.length;g++){var j=Object(i["a"])(O[g],2),x=j[0],k=j[1];a.push([v,y,x,k["原本"].toFixed(2),k["0.5%"].toFixed(2),k["1.5%"].toFixed(2),k["3.0%"].toFixed(2),k["3.5%"].toFixed(2),k["5.0%"].toFixed(2)])}return a}return""}},methods:{onSuccess:function(e,t){var r=e,n=new FileReader,o=this;n.onload=function(e){var t=new Uint8Array(e.target.result),r=d.a.read(t,{type:"array"}),n=r.SheetNames[0],a=r.Sheets[n];o.array=d.a.utils.sheet_to_json(a),o.loaded=!1},n.readAsArrayBuffer(r)},download:function(){var e="data:text/csv;charset=utf-8,業務員,客戶簡稱,貨品名稱,銷貨金額,0.5%,1.5%,3.0%,3.5%,5.0%\n"+this.computedArray.map(function(e){return e.join(",")}).join("\n"),t=encodeURI(e),r=document.createElement("a");r.setAttribute("href",t),r.setAttribute("download","Output.csv"),document.body.appendChild(r),r.click()}}},p=v,f=(r("034f"),r("2877")),m=Object(f["a"])(p,o,a,!1,null,null,null),h=m.exports,_=r("2f62");n["a"].use(_["a"]);var y=new _["a"].Store({state:{},mutations:{},actions:{}});n["a"].config.productionTip=!1,new n["a"]({store:y,render:function(e){return e(h)}}).$mount("#app")},"64a9":function(e,t,r){}});
//# sourceMappingURL=app.16b22dcc.js.map